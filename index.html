<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <title>Nền tảng Gia sư</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  <style>
    /* RESET & VARIABLES */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    :root {
      --primary-color: #3b82f6;
      --primary-dark: #1d4ed8;
      --primary-light: #dbeafe;
      --primary-gradient: linear-gradient(135deg, #3b82f6, #60a5fa);
      --secondary-color: #10b981;
      --accent-color: #f97316;
      --text-primary: #111827;
      --text-secondary: #4b5563;
      --text-light: #9ca3af;
      --bg-light: #f9fafb;
      --bg-white: #ffffff;
      --bg-card: #ffffff;
      --overlay-bg: rgba(0, 0, 0, 0.5);
      --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
      --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
      --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
      --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
      --border-radius: 0.5rem;
      --border-radius-lg: 0.75rem;
      --border-radius-xl: 1rem;
      --transition: all 0.3s ease;
      --font-family: 'Quicksand', 'Segoe UI', Roboto, -apple-system, BlinkMacSystemFont, sans-serif;
      --header-height: 70px;
      --sidebar-width: 280px;
    }

    /* DARK MODE */
    body.dark-mode {
      --primary-light: rgba(79, 70, 229, 0.15);
      --text-primary: #f3f4f6;
      --text-secondary: #d1d5db;
      --text-light: #9ca3af;
      --bg-light: #0f172a;
      --bg-white: #1e293b;
      --bg-card: #1e293b;
    }

    body {
      font-family: var(--font-family);
      background-color: var(--bg-light);
      color: var(--text-primary);
      line-height: 1.6;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      font-size: 16px;
      overflow-x: hidden;
    }

    /* HEADER */
    .header {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      height: var(--header-height);
      background: var(--primary-gradient);
      backdrop-filter: blur(10px);
      color: white;
      box-shadow: var(--shadow-lg);
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 1rem;
      z-index: 1000;
    }

    .header-left {
      display: flex;
      align-items: center;
      gap: 1rem;
    }

    .menu-toggle {
      background: rgba(255, 255, 255, 0.15);
      border: 1px solid rgba(255, 255, 255, 0.2);
      color: white;
      padding: 0.5rem 1rem;
      border-radius: var(--border-radius);
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      transition: var(--transition);
      backdrop-filter: blur(5px);
    }

    .menu-toggle:hover {
      background: rgba(255, 255, 255, 0.25);
      transform: translateY(-1px);
    }

    .logo {
      font-size: 1.25rem;
      font-weight: 600;
      letter-spacing: 0.5px;
    }

    .logo-subtitle {
      font-size: 0.75rem;
      opacity: 0.9;
      font-weight: 300;
      margin-top: 2px;
    }

    .header-right {
      display: flex;
      align-items: center;
      gap: 0.75rem;
    }

    .theme-toggle, .feedback-toggle {
      background: rgba(255, 255, 255, 0.15);
      border: 1px solid rgba(255, 255, 255, 0.2);
      color: white;
      width: 40px;
      height: 40px;
      border-radius: var(--border-radius);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: var(--transition);
      backdrop-filter: blur(5px);
    }

    .theme-toggle:hover, .feedback-toggle:hover {
      background: rgba(255, 255, 255, 0.25);
      transform: translateY(-1px);
    }

    /* OVERLAY */
    .overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: var(--overlay-bg);
      z-index: 997;
    }

    .overlay.active {
      display: block;
    }

    /* SIDEBAR */
    .sidebar {
      position: fixed;
      top: var(--header-height);
      left: -100%;
      width: var(--sidebar-width);
      height: calc(100vh - var(--header-height));
      background-color: var(--bg-white);
      transition: var(--transition);
      z-index: 998;
      box-shadow: var(--shadow-xl);
      overflow-y: auto;
      padding: 1rem 0;
      border-right: 1px solid rgba(229, 231, 235, 0.5);
    }

    .sidebar.open {
      left: 0;
    }

    .sidebar-title {
      padding: 0.5rem 1.5rem 1rem;
      color: var(--text-secondary);
      font-size: 0.875rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      border-bottom: 1px solid rgba(243, 244, 246, 0.5);
      margin-bottom: 1rem;
    }

    .sidebar-menu {
      list-style: none;
      margin: 0 0.75rem;
    }

    .sidebar-item {
      padding: 0.875rem 1.25rem;
      cursor: pointer;
      transition: var(--transition);
      color: var(--text-secondary);
      font-weight: 500;
      display: flex;
      align-items: center;
      gap: 1rem;
      border-radius: var(--border-radius);
      margin: 0.5rem 0;
      position: relative;
    }

    .sidebar-item:hover {
      background-color: var(--primary-light);
      color: var(--primary-color);
      transform: translateX(5px);
    }

    .sidebar-item.active {
      background-color: var(--primary-light);
      color: var(--primary-color);
      font-weight: 600;
    }

    .sidebar-item::before {
      content: '';
      position: absolute;
      left: 0;
      top: 0;
      width: 0;
      height: 100%;
      background-color: var(--primary-color);
      border-radius: var(--border-radius);
      opacity: 0.2;
      transition: var(--transition);
    }

    .sidebar-item:hover::before,
    .sidebar-item.active::before {
      width: 4px;
    }

    .sidebar-icon {
      width: 20px;
      height: 20px;
      text-align: center;
      font-size: 1.125rem;
    }

    .sidebar-divider {
      height: 1px;
      background-color: rgba(229, 231, 235, 0.5);
      margin: 1rem 1.25rem;
    }

    /* DROPDOWN */
    .dropdown-arrow {
      margin-left: auto;
      transition: transform 0.3s ease;
    }

    .sidebar-item.dropdown.active .dropdown-arrow {
      transform: rotate(180deg);
    }

    .dropdown-menu {
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.3s ease;
      margin-left: 2rem;
    }

    .dropdown-menu.open {
      max-height: 300px;
    }

    /* MAIN CONTENT */
    .main-container {
      flex: 1;
      margin-top: var(--header-height);
      transition: var(--transition);
    }

    .main-content {
      max-width: 1200px;
      margin: 0 auto;
      padding: 2rem 1rem;
    }

    /* WELCOME SECTION */
    .welcome-section {
      background: linear-gradient(135deg, var(--bg-card), rgba(255,255,255,0.05));
      border-radius: var(--border-radius-xl);
      padding: 2rem;
      margin-bottom: 2rem;
      border-left: 4px solid var(--primary-color);
      box-shadow: var(--shadow-lg);
      position: relative;
      overflow: hidden;
    }

    .welcome-section::before {
      content: "";
      position: absolute;
      top: 0;
      right: 0;
      width: 120px;
      height: 120px;
      background: var(--primary-gradient);
      opacity: 0.05;
      border-radius: 0 0 0 100%;
    }

    .welcome-title {
      font-size: 1.5rem;
      margin-bottom: 1rem;
      color: var(--primary-color);
      position: relative;
      display: inline-block;
      cursor: pointer;
    }

    .welcome-title::after {
      content: '';
      position: absolute;
      bottom: -6px;
      left: 0;
      width: 40px;
      height: 3px;
      background: var(--primary-gradient);
      border-radius: 3px;
    }

    .welcome-content {
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.5s ease, opacity 0.5s ease;
      opacity: 0;
    }

    .welcome-content.show {
      max-height: 500px;
      opacity: 1;
    }

    .welcome-content p {
      margin-bottom: 1rem;
      color: var(--text-secondary);
      line-height: 1.7;
    }

    .welcome-content strong {
      color: var(--primary-color);
      font-weight: 600;
    }

    /* NOTIFICATION */
    .notification {
      background: var(--primary-gradient);
      color: white;
      padding: 1rem 1.5rem;
      border-radius: var(--border-radius);
      margin-bottom: 1.5rem;
      display: flex;
      align-items: center;
      justify-content: space-between;
      box-shadow: var(--shadow-lg);
      animation: slideIn 0.5s ease-out;
      position: relative;
      overflow: hidden;
    }

    .notification::before {
      content: "";
      position: absolute;
      top: -10px;
      right: -10px;
      width: 80px;
      height: 80px;
      background: rgba(255,255,255,0.1);
      filter: blur(15px);
      border-radius: 50%;
    }

    .notification-content {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      flex: 1;
      position: relative;
      z-index: 2;
    }

    .notification-icon {
      width: 20px;
      height: 20px;
    }

    .notification-text {
      font-weight: 500;
    }

    .notification-close {
      background: transparent;
      border: none;
      color: white;
      padding: 0.5rem;
      cursor: pointer;
      transition: var(--transition);
      position: relative;
      z-index: 2;
    }

    .notification-close:hover {
      transform: scale(1.1);
    }

    /* CHATBOT CONTAINER */
    .chatbot-container {
      background-color: var(--bg-card);
      border-radius: var(--border-radius-xl);
      box-shadow: var(--shadow-lg);
      overflow: hidden;
      margin-bottom: 2rem;
      min-height: 600px;
      display: flex;
      flex-direction: column;
      border: 1px solid rgba(229, 231, 235, 0.3);
      position: relative;
    }

    .chatbot-container::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: var(--primary-gradient);
    }

    .chatbot-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 1rem;
      background: rgba(59, 130, 246, 0.05);
      border-bottom: 1px solid rgba(229, 231, 235, 0.3);
    }

    .chatbot-title {
      font-weight: 600;
      color: var(--text-primary);
    }

    .expand-btn {
      background: var(--primary-gradient);
      color: white;
      border: none;
      padding: 0.5rem;
      border-radius: var(--border-radius);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: var(--transition);
      text-decoration: none;
    }

    .expand-btn:hover {
      transform: scale(1.05);
      box-shadow: var(--shadow-md);
    }

    .chatbot-frame {
      border: none;
      width: 100%;
      flex: 1;
      min-height: 550px;
    }

    /* FEEDBACK SIDEBAR */
    .feedback-sidebar {
      position: fixed;
      top: 0;
      right: -100%;
      width: min(400px, 100vw);
      height: 100vh;
      background-color: var(--bg-white);
      box-shadow: var(--shadow-xl);
      transition: var(--transition);
      z-index: 999;
      display: flex;
      flex-direction: column;
    }

    .feedback-sidebar.open {
      right: 0;
    }

    .feedback-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 1.5rem;
      background: var(--primary-gradient);
      color: white;
    }

    .feedback-title {
      font-size: 1.25rem;
      font-weight: 600;
    }

    .feedback-close {
      background: rgba(255, 255, 255, 0.15);
      border: 1px solid rgba(255, 255, 255, 0.2);
      color: white;
      width: 36px;
      height: 36px;
      border-radius: var(--border-radius);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: var(--transition);
    }

    .feedback-close:hover {
      background: rgba(255, 255, 255, 0.25);
      transform: rotate(90deg);
    }

    .feedback-content {
      flex: 1;
      padding: 0;
    }

    .feedback-frame {
      width: 100%;
      height: 100%;
      border: none;
    }

    /* FOOTER */
    .footer {
      text-align: center;
      padding: 2rem 1rem;
      border-top: 1px solid rgba(229, 231, 235, 0.3);
      background-color: var(--bg-white);
      box-shadow: var(--shadow-lg);
      margin-top: auto;
    }

    .footer-links {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 1.5rem;
      margin-bottom: 1.5rem;
    }

    .footer-link {
      color: var(--text-secondary);
      text-decoration: none;
      transition: var(--transition);
      position: relative;
      cursor: pointer;
    }

    .footer-link::after {
      content: '';
      position: absolute;
      bottom: -4px;
      left: 0;
      width: 0;
      height: 2px;
      background-color: var(--primary-color);
      transition: var(--transition);
      border-radius: 2px;
    }

    .footer-link:hover {
      color: var(--primary-color);
    }

    .footer-link:hover::after {
      width: 100%;
    }

    .social-links {
      display: flex;
      justify-content: center;
      gap: 1rem;
      margin-bottom: 1.5rem;
    }

    .social-link {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 40px;
      height: 40px;
      background-color: var(--bg-light);
      color: var(--text-secondary);
      border-radius: 50%;
      transition: var(--transition);
      box-shadow: var(--shadow-sm);
      text-decoration: none;
    }

    .social-link:hover {
      background-color: var(--primary-light);
      color: var(--primary-color);
      transform: translateY(-2px);
      box-shadow: var(--shadow-md);
    }

    .copyright {
      color: var(--text-light);
      font-size: 0.875rem;
    }

    /* MODALS */
    .modal {
      display: none;
      position: fixed;
      z-index: 2000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: var(--overlay-bg);
    }

    .modal-content {
      background-color: var(--bg-white);
      margin: 10% auto;
      padding: 2rem;
      border-radius: var(--border-radius);
      box-shadow: var(--shadow-xl);
      width: 90%;
      max-width: 500px;
      position: relative;
      animation: modalSlideIn 0.3s ease-out;
    }

    .modal-close {
      position: absolute;
      top: 1rem;
      right: 1rem;
      background: none;
      border: none;
      font-size: 1.5rem;
      cursor: pointer;
      color: var(--text-secondary);
      transition: var(--transition);
    }

    .modal-close:hover {
      color: var(--text-primary);
      transform: rotate(90deg);
    }

    .full-modal {
      display: none;
      position: fixed;
      z-index: 2000;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: var(--overlay-bg);
    }

    .full-modal-content {
      position: relative;
      width: 100%;
      height: 100%;
      background: var(--bg-white);
      display: flex;
      flex-direction: column;
    }

    .full-modal-header {
      background: var(--primary-gradient);
      padding: 1rem 1.5rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
      color: white;
    }

    .full-modal-title {
      font-size: 1.25rem;
      font-weight: 600;
    }

    .full-modal-body {
      flex: 1;
      padding: 1.5rem;
      overflow-y: auto;
    }

    .help-section {
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }

    .help-item {
      padding: 1rem 1.25rem;
      background-color: var(--bg-white);
      border-radius: var(--border-radius);
      box-shadow: var(--shadow-sm);
      cursor: pointer;
      transition: var(--transition);
      display: flex;
      align-items: center;
      gap: 1rem;
      border: 1px solid rgba(229, 231, 235, 0.3);
    }

    .help-item:hover {
      background-color: var(--primary-light);
      color: var(--primary-color);
      transform: translateY(-2px);
      box-shadow: var(--shadow-md);
    }

    /* ANIMATIONS */
    @keyframes slideIn {
      from { opacity: 0; transform: translateY(-10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    @keyframes modalSlideIn {
      from { opacity: 0; transform: scale(0.9); }
      to { opacity: 1; transform: scale(1); }
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .welcome-section {
      animation: fadeIn 0.6s ease-out;
    }

    .chatbot-container {
      animation: fadeIn 0.8s ease-out;
    }

    /* RESPONSIVE DESIGN */
    
    /* Tablet */
    @media (max-width: 1024px) {
      .main-content {
        padding: 1.5rem;
      }
      
      .chatbot-frame {
        min-height: 500px;
      }
    }

    /* Mobile */
    @media (max-width: 768px) {
      :root {
        --header-height: 60px;
        --sidebar-width: 260px;
      }

      .header {
        padding: 0 0.75rem;
      }

      .logo {
        font-size: 1.125rem;
      }

      .logo-subtitle {
        display: none;
      }

      .main-content {
        padding: 1rem;
      }

      .welcome-section {
        padding: 1.5rem;
        margin-bottom: 1.5rem;
      }

      .welcome-title {
        font-size: 1.25rem;
      }

      .notification {
        padding: 0.875rem 1rem;
      }

      .notification-text {
        font-size: 0.875rem;
      }

      .chatbot-frame {
        min-height: 450px;
      }

      .footer-links {
        flex-direction: column;
        gap: 1rem;
      }

      .modal-content {
        margin: 20% auto;
        padding: 1.5rem;
        width: 95%;
      }
    }

    /* Small Mobile */
    @media (max-width: 480px) {
      :root {
        --sidebar-width: 240px;
      }

      .header {
        padding: 0 0.5rem;
      }

      .main-content {
        padding: 0.75rem;
      }

      .welcome-section {
        padding: 1.25rem;
      }

      .chatbot-frame {
        min-height: 400px;
      }

      .notification {
        padding: 0.75rem;
        flex-direction: column;
        gap: 0.75rem;
        text-align: center;
      }

      .notification-content {
        flex-direction: column;
        gap: 0.5rem;
      }
    }

    /* Desktop */
    @media (min-width: 1200px) {
      .sidebar {
        left: 0;
      }

      .main-container {
        margin-left: var(--sidebar-width);
      }

      .overlay.active {
        display: none;
      }

      .main-content {
        padding: 2rem 2.5rem;
      }
    }

    /* Large Desktop */
    @media (min-width: 1440px) {
      .main-content {
        padding: 2.5rem 3rem;
      }

      .chatbot-frame {
        min-height: 700px;
      }
    }

    /* Print Styles */
    @media print {
      .header, .sidebar, .feedback-sidebar, .overlay, .modal {
        display: none !important;
      }
      
      .main-container {
        margin: 0 !important;
      }
      
      .chatbot-container {
        display: none !important;
      }
    }

    /* High Contrast Mode */
    @media (prefers-contrast: high) {
      :root {
        --shadow-sm: 0 2px 4px 0 rgba(0, 0, 0, 0.3);
        --shadow-md: 0 6px 12px -2px rgba(0, 0, 0, 0.3);
        --shadow-lg: 0 12px 24px -4px rgba(0, 0, 0, 0.3);
        --shadow-xl: 0 24px 48px -8px rgba(0, 0, 0, 0.3);
      }
    }

    /* Reduced Motion */
    @media (prefers-reduced-motion: reduce) {
      *, *::before, *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
      }
    }

    /* Focus Styles for Accessibility */
    button:focus,
    .sidebar-item:focus,
    .footer-link:focus {
      outline: 2px solid var(--primary-color);
      outline-offset: 2px;
    }

    /* Hover states for touch devices */
    @media (hover: none) {
      .sidebar-item:hover,
      .menu-toggle:hover,
      .theme-toggle:hover,
      .feedback-toggle:hover {
        transform: none;
      }
    }
  </style>
</head>
<body>
  <!-- Welcome Popup -->
  <div id="welcomePopup" class="modal" style="display: block;">
    <div class="modal-content">
      <button class="modal-close" onclick="closeWelcomePopup()" aria-label="Đóng">×</button>
      <h2>Chào mừng đến với Nền tảng Gia sư ảo!</h2>
      <p>Nhấn vào 'Môn học' để chọn môn, dùng chatbot để hỏi bài nhé! Hãy nhớ AI chỉ hỗ trợ bạn học tập hiệu quả hơn thôi, không phải là một công cụ để giải bài tập đâu :)</p>
    </div>
  </div>

  <!-- Header -->
  <header class="header">
    <div class="header-left">
      <button class="menu-toggle" onclick="toggleSidebar()" aria-label="Menu">
        <span>Môn học</span>
      </button>
      <div class="logo">
        <div>Nền tảng Gia sư</div>
        <div class="logo-subtitle">Học mọi lúc, mọi nơi</div>
      </div>
    </div>
    <div class="header-right">
      <button class="theme-toggle" onclick="toggleTheme()" aria-label="Chuyển đổi giao diện">
        <span>◐</span>
      </button>
      <button class="feedback-toggle" onclick="toggleFeedback()" aria-label="Góp ý">
        <span>✉</span>
      </button>
    </div>
  </header>

  <!-- Overlay -->
  <div class="overlay" id="overlay"></div>

  <!-- Sidebar -->
  <aside class="sidebar" id="sidebar">
    <div class="sidebar-title">Chọn môn học</div>
    <ul class="sidebar-menu">
      <li class="sidebar-item active" data-tutor="math" onclick="switchTutor('math')">
        <div class="sidebar-icon">∑</div>
        <span>Gia sư Toán</span>
      </li>
      <li class="sidebar-item" data-tutor="physics" onclick="switchTutor('physics')">
        <div class="sidebar-icon">⚡</div>
        <span>Gia sư Vật Lý</span>
      </li>
      <li class="sidebar-item" data-tutor="english" onclick="switchTutor('english')">
        <div class="sidebar-icon">A</div>
        <span>Gia sư Anh</span>
      </li>
      <li class="sidebar-item" data-tutor="literature" onclick="switchTutor('literature')">
        <div class="sidebar-icon">※</div>
        <span>Gia sư Văn</span>
      </li>

      <li class="sidebar-divider"></li>

      <!-- Dropdown Options -->
      <li class="sidebar-item dropdown" onclick="toggleDropdown(this)">
        <div class="sidebar-icon">⚙</div>
        <span>Tùy chọn</span>
        <div class="dropdown-arrow">▼</div>
      </li>
      <div class="dropdown-menu">
        <li class="sidebar-item" onclick="showHelpModal()">
          <div class="sidebar-icon">?</div>
          <span>Trợ giúp</span>
        </li>
        <li class="sidebar-item" onclick="toggleTheme()">
          <div class="sidebar-icon">◐</div>
          <span>Giao diện tối/sáng</span>
        </li>
      </div>
    </ul>
  </aside>

  <!-- Feedback Sidebar -->
  <aside class="feedback-sidebar" id="feedbackSidebar">
    <div class="feedback-header">
      <h2 class="feedback-title">Góp ý của bạn</h2>
      <button class="feedback-close" onclick="toggleFeedback()" aria-label="Đóng">×</button>
    </div>
    <div class="feedback-content">
      <iframe 
        class="feedback-frame"
        src="https://docs.google.com/forms/d/e/1FAIpQLSfP8p-6TarFlG8EHTYOXcfYbKObW7khCbtv9JNcUO8RWm3RLA/viewform?embedded=true" 
        frameborder="0" 
        marginheight="0" 
        marginwidth="0">
        Đang tải…
      </iframe>
    </div>
  </aside>

  <!-- Main Container -->
  <div class="main-container">
    <main class="main-content">
      <!-- Welcome Section -->
      <section class="welcome-section">
        <h2 class="welcome-title" onclick="toggleWelcomeContent()" id="welcomeTitle">Gia sư Toán</h2>
        <div class="welcome-content show" id="welcomeContent">
          <p>
            Chào mừng bạn đến với <strong>Gia sư Toán</strong>. Đây là nơi bạn có thể nhận sự trợ giúp của AI 'Gia sư toán'. Gia sư toán sẽ hướng dẫn bạn giải bài tập chi tiết, rõ ràng, dễ hiểu, giúp bạn học toán hiệu quả.
          </p>
          <p>
            Hãy sử dụng trợ lý AI bên dưới để được hỗ trợ giải bài tập và hiểu sâu hơn về các khái niệm toán học phức tạp. Trợ lý của chúng tôi có thể hỗ trợ từ toán cơ bản đến nâng cao.
          </p>
          <p><strong>Lời khuyên:</strong> Hãy làm bài tập đều đặn mỗi ngày!</p>
        </div>
      </section>

      <!-- Notification -->
      <div class="notification" id="expandNotification">
        <div class="notification-content">
          <span class="notification-icon">⤢</span>
          <div class="notification-text">
            <strong>Mở rộng khung chat</strong><br>
            Màn hình chat quá nhỏ? Bấm vào nút phóng to ở góc trên bên phải!
          </div>
        </div>
        <button class="notification-close" onclick="closeNotification()" aria-label="Đóng thông báo">
          <span>×</span>
        </button>
      </div>

      <!-- Chatbot Container -->
      <section class="chatbot-container">
        <div class="chatbot-header">
          <div class="chatbot-title">Trò chuyện với AI</div>
          <a href="https://udify.app/chat/M1dEP0lGehU2sX7e" class="expand-btn" target="_blank" title="Mở rộng" id="expandBtn">
            <span>⤢</span>
          </a>
        </div>
        <iframe 
          id="chatbotFrame"
          class="chatbot-frame"
          src="https://udify.app/chatbot/M1dEP0lGehU2sX7e"
          allow="microphone"
          scrolling="yes"
          loading="lazy">
        </iframe>
      </section>
    </main>
  </div>

  <!-- Footer -->
  <footer class="footer">
    <div class="footer-links">
      <a href="#" class="footer-link" onclick="showFooterModal('Giới thiệu')">Giới thiệu</a>
      <a href="#" class="footer-link" onclick="showFooterModal('Chính sách riêng tư')">Chính sách riêng tư</a>
      <a href="#" class="footer-link" onclick="showFooterModal('Điều khoản sử dụng')">Điều khoản sử dụng</a>
      <a href="#" class="footer-link" onclick="showFooterModal('Liên hệ')">Liên hệ</a>
    </div>

    <div class="social-links">
      <a href="https://mail.google.com/mail/?view=cm&fs=1&to=legiahuyltv@gmail.com&su=Liên%20hệ%20từ%20Nền%20tảng%20Gia%20sư&body=Xin%20chào,%0A%0ATôi%20muốn%20liên%20hệ%20về:%0A%0A" class="social-link" aria-label="Gmail" title="Gửi email qua Gmail" target="_blank">
        <span>✉</span>
      </a>
    </div>

    <div class="copyright">&copy; 2025 Nền tảng Gia sư. All rights reserved.</div>
  </footer>

  <!-- Footer Modal -->
  <div id="footerModal" class="modal">
    <div class="modal-content">
      <button class="modal-close" onclick="closeFooterModal()" aria-label="Đóng">×</button>
      <div id="modalText"></div>
    </div>
  </div>

  <!-- Help Modal -->
  <div id="helpModal" class="full-modal">
    <div class="full-modal-content">
      <div class="full-modal-header">
        <h2 class="full-modal-title">Trợ giúp</h2>
        <button class="feedback-close" onclick="closeHelpModal()" aria-label="Đóng trợ giúp">×</button>
      </div>
      <div class="full-modal-body">
        <div class="help-section">
          <div class="help-item" onclick="showTopicModal('using-tutor')">
            <div class="sidebar-icon">◉</div>
            <span>Cách sử dụng Gia sư Toán</span>
          </div>
          <div class="help-item" onclick="showTopicModal('adding-images')">
            <div class="sidebar-icon">▣</div>
            <span>Cách thêm hình ảnh vào AI</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Topic Modal -->
  <div id="topicModal" class="full-modal">
    <div class="full-modal-content">
      <div class="full-modal-header">
        <h2 class="full-modal-title" id="topicTitle">Chi tiết</h2>
        <button class="feedback-close" onclick="closeTopicModal()" aria-label="Đóng">×</button>
      </div>
      <div class="full-modal-body" id="topicContent">
        <!-- Content will be loaded here -->
      </div>
    </div>
  </div>

  <script>
    // Tutor mapping data
    const tutorMapping = {
      math: {
        title: 'Gia sư Toán',
        description: 'Chào mừng bạn đến với <strong>Gia sư Toán</strong>. Đây là nơi bạn có thể nhận sự trợ giúp của AI "Gia sư toán". Gia sư toán sẽ hướng dẫn bạn giải bài tập chi tiết, rõ ràng, dễ hiểu, giúp bạn học toán hiệu quả.',
        iframe: 'https://udify.app/chatbot/M1dEP0lGehU2sX7e',
        expandLink: 'https://udify.app/chat/M1dEP0lGehU2sX7e'
      },
      physics: {
        title: 'Gia sư Vật Lý',
        description: 'Chào mừng bạn đến với <strong>Gia sư Vật Lý</strong>. Khám phá thế giới vật lý với AI của chúng tôi. Học hỏi các định luật, hiện tượng vật lý, và cách giải bài tập hiệu quả.',
        iframe: 'https://udify.app/chatbot/uVYHltm1bdXM9Xmr',
        expandLink: 'https://udify.app/chat/uVYHltm1bdXM9Xmr'
      },
      english: {
        title: 'Gia sư Anh',
        description: 'Chào mừng bạn đến với <strong>Gia sư Anh</strong>. Tại đây, bạn có thể học tiếng Anh qua các bài giảng và tương tác với trợ lý AI.',
        iframe: 'https://udify.app/chatbot/OLxmx5Fm8v6rTAXo',
        expandLink: 'https://udify.app/chat/OLxmx5Fm8v6rTAXo'
      },
      literature: {
        title: 'Gia sư Văn',
        description: 'Chào mừng bạn đến với <strong>Gia sư Văn</strong>. Đây là nơi chia sẻ kiến thức và các bài giảng về Ngữ Văn.',
        iframe: 'https://udify.app/chatbot/6UaZkt1RQQHDqfJ7',
        expandLink: 'https://udify.app/chat/6UaZkt1RQQHDqfJ7'
      }
    };

    // Topic contents for help modal
    const topicContents = {
      'using-tutor': `
        <h2>Cách sử dụng Gia sư Toán</h2>
        <p>1. Chọn 'Gia sư Toán' trong menu.</p>
        <p>2. Gõ câu hỏi vào chatbot (ví dụ: 'Giải phương trình x^2 = 4').</p>
        <p>3. Thử hỏi các câu hỏi khác trong chatbot!</p>
      `,
      'adding-images': `
        <h2>Cách thêm hình ảnh vào AI</h2>
        <p>Khi cần gửi hình ảnh để AI giúp giải toán hoặc bất kỳ bài tập nào:</p>
        <p><strong>Bước 1:</strong> Chuẩn bị hình ảnh rõ ràng, đầy đủ của bài toán hoặc bài tập.</p>
        <p><strong>Bước 2:</strong> Nhấn vào nút tải lên (icon hình kẹp giấy) trong khung chat.</p>
        <p><strong>Bước 3:</strong> Chọn hình ảnh từ thiết bị của bạn.</p>
        <p><strong>Bước 4:</strong> Kèm theo một mô tả ngắn về nội dung hình ảnh và câu hỏi của bạn.</p>
        <p><strong>Bước 5:</strong> Nhấn gửi và đợi AI phân tích hình ảnh.</p>
        <h3>Lưu ý khi gửi hình ảnh:</h3>
        <ul>
          <li>Hình ảnh phải rõ nét, không bị mờ hoặc quá tối</li>
          <li>Nên chụp thẳng bài toán, tránh góc nghiêng</li>
          <li>Đảm bảo tất cả các phần của bài toán đều nằm trong hình</li>
          <li>Tránh các yếu tố gây nhiễu như bóng đổ, vết bẩn</li>
          <li>Nếu AI không nhận diện được, hãy thử chụp lại với điều kiện ánh sáng tốt hơn</li>
        </ul>
      `
    };

    // Footer modal content mapping
    const modalContentMapping = {
      "Giới thiệu": `<h2>Giới thiệu</h2>
        <p>Gia sư Ảo là nền tảng học trực tuyến chuyên biệt về toán học, ngữ văn, anh văn. Hướng dẫn giải bài tập chi tiết và những mẹo học tập hiệu quả. Chúng tôi cam kết mang đến trải nghiệm học tập toàn diện, từ kiến thức cơ bản đến nâng cao, phù hợp với mọi đối tượng học sinh.</p>`,
      
      "Liên hệ": `<h2>Liên hệ</h2>
        <p>Gmail: <a href="https://mail.google.com/mail/?view=cm&fs=1&to=legiahuyltv@gmail.com&su=Liên%20hệ%20từ%20Nền%20tảng%20Gia%20sư&body=Xin%20chào,%0A%0ATôi%20muốn%20liên%20hệ%20về:%0A%0A" target="_blank">legiahuyltv@gmail.com</a></p>`,
      
      "Chính sách riêng tư": `<h2>Chính sách riêng tư</h2>
        <p>Chúng tôi tôn trọng và bảo vệ quyền riêng tư của người dùng. Thông tin cá nhân của bạn được bảo mật và chỉ được sử dụng để cải thiện trải nghiệm học tập. Chúng tôi không chia sẻ dữ liệu cá nhân với bên thứ ba khi chưa có sự đồng ý. Mọi dữ liệu học tập và tiến trình của bạn được lưu trữ an toàn và chỉ bạn cùng giáo viên hướng dẫn mới có quyền truy cập.</p>`,
      
      "Điều khoản sử dụng": `<h2>Điều khoản sử dụng</h2>
        <h3>1. Chấp nhận điều khoản</h3>
        <p>Bằng việc truy cập và sử dụng chatbot Gia sư Toán ("Chatbot"), bạn đồng ý tuân thủ và bị ràng buộc bởi tất cả các điều khoản và điều kiện được nêu trong văn bản này. Nếu bạn không đồng ý với bất kỳ phần nào của các điều khoản này, vui lòng không sử dụng Chatbot.</p>
        <h3>2. Điều kiện sử dụng</h3>
        <p>Chatbot Gia sư Toán được thiết kế để hỗ trợ học tập, giải đáp thắc mắc và cung cấp tài liệu liên quan đến toán học. Chatbot chỉ cung cấp thông tin tham khảo và không thay thế cho việc học tập chính thức hoặc tư vấn từ giáo viên có trình độ. Người dùng phải từ 13 tuổi trở lên hoặc có sự giám sát của phụ huynh/người giám hộ khi sử dụng Chatbot.</p>
        <h3>3. Quyền sở hữu trí tuệ</h3>
        <p>Tất cả nội dung được cung cấp thông qua Chatbot, bao gồm nhưng không giới hạn ở văn bản, hình ảnh, logo, bài giảng, và giải pháp bài tập, đều thuộc quyền sở hữu của Gia sư Toán hoặc các đối tác cấp phép. Người dùng được cấp quyền sử dụng nội dung chỉ cho mục đích học tập cá nhân và không được sao chép, phân phối, sửa đổi, hiển thị công khai hoặc tạo các sản phẩm phái sinh mà không có sự cho phép bằng văn bản.</p>`
    };

    // Functions
    function closeWelcomePopup() {
      const popup = document.getElementById('welcomePopup');
      if (popup) {
        popup.style.display = 'none';
      }
    }

    function toggleSidebar() {
      const sidebar = document.getElementById('sidebar');
      const overlay = document.querySelector('.overlay');
      
      if (sidebar && overlay) {
        sidebar.classList.toggle('open');
        overlay.classList.toggle('active');
      }
    }

    function toggleTheme() {
      document.body.classList.toggle('dark-mode');
      const themeIcon = document.querySelector('.theme-toggle span');
      if (themeIcon) {
        themeIcon.textContent = document.body.classList.contains('dark-mode') 
          ? '◑' 
          : '◐';
      }
      
      // Update sidebar theme icon too
      const sidebarThemeItems = document.querySelectorAll('.dropdown-menu .sidebar-item');
      sidebarThemeItems.forEach(item => {
        const icon = item.querySelector('.sidebar-icon');
        if (icon && icon.textContent === '◐') {
          icon.textContent = document.body.classList.contains('dark-mode') 
            ? '◑' 
            : '◐';
        }
      });
      
      // Close sidebar on mobile after theme change
      if (window.innerWidth < 1200) {
        const sidebar = document.getElementById('sidebar');
        const overlay = document.getElementById('overlay');
        if (sidebar && overlay) {
          sidebar.classList.remove('open');
          overlay.classList.remove('active');
        }
      }
    }

    function toggleFeedback() {
      const feedbackSidebar = document.getElementById('feedbackSidebar');
      const overlay = document.querySelector('.overlay');
      
      if (feedbackSidebar && overlay) {
        feedbackSidebar.classList.toggle('open');
        overlay.classList.toggle('active');
        
        // Close main sidebar on mobile
        if (window.innerWidth < 1200) {
          const sidebar = document.getElementById('sidebar');
          if (sidebar) {
            sidebar.classList.remove('open');
          }
        }
      }
    }

    function toggleDropdown(element) {
      element.classList.toggle('active');
      const dropdownMenu = element.nextElementSibling;
      if (dropdownMenu) {
        dropdownMenu.classList.toggle('open');
      }
    }

    function switchTutor(tutorType) {
      // Update active class
      const menuItems = document.querySelectorAll('.sidebar-item[data-tutor]');
      menuItems.forEach(item => {
        item.classList.remove('active');
        if (item.getAttribute('data-tutor') === tutorType) {
          item.classList.add('active');
        }
      });

      const selectedTutor = tutorMapping[tutorType];

      if (selectedTutor) {
        // Update welcome section
        const welcomeTitle = document.getElementById('welcomeTitle');
        const welcomeContent = document.getElementById('welcomeContent');
        
        if (welcomeTitle) {
          welcomeTitle.textContent = selectedTutor.title;
        }
        
        if (welcomeContent) {
          welcomeContent.innerHTML = `
            <p>${selectedTutor.description}</p>
            <p>Hãy sử dụng trợ lý AI bên dưới để được hỗ trợ giải bài tập và hiểu sâu hơn về các khái niệm phức tạp. Trợ lý của chúng tôi có thể hỗ trợ từ cơ bản đến nâng cao.</p>
            <p><strong>Lời khuyên:</strong> Hãy làm bài tập đều đặn mỗi ngày!</p>
          `;
        }

        // Update chatbot iframe
        const chatbotFrame = document.getElementById('chatbotFrame');
        if (chatbotFrame) {
          chatbotFrame.src = selectedTutor.iframe;
        }

        // Update expand button link
        const expandBtn = document.getElementById('expandBtn');
        if (expandBtn) {
          expandBtn.href = selectedTutor.expandLink;
        }
      }

      // Close sidebar on mobile
      if (window.innerWidth < 1200) {
        toggleSidebar();
      }
    }

    function toggleWelcomeContent() {
      const content = document.getElementById('welcomeContent');
      if (content) {
        content.classList.toggle('show');
      }
    }

    function closeNotification() {
      const notification = document.getElementById('expandNotification');
      if (notification) {
        notification.style.display = 'none';
        localStorage.setItem('expandNotificationClosed', 'true');
      }
    }

    function showHelpModal() {
      const helpModal = document.getElementById('helpModal');
      if (helpModal) {
        helpModal.style.display = 'block';
      }

      // Close sidebar on mobile
      if (window.innerWidth < 1200) {
        toggleSidebar();
      }
    }

    function closeHelpModal() {
      const helpModal = document.getElementById('helpModal');
      if (helpModal) {
        helpModal.style.display = 'none';
      }
    }

    function showTopicModal(topicId) {
      const topicModal = document.getElementById('topicModal');
      const topicContent = document.getElementById('topicContent');
      const topicTitle = document.getElementById('topicTitle');
      const helpModal = document.getElementById('helpModal');

      if (topicModal && topicContent && topicTitle) {
        const content = topicContents[topicId];
        if (content) {
          topicContent.innerHTML = content;
          topicTitle.textContent = topicId === 'using-tutor' ? 'Cách sử dụng Gia sư' : 'Cách thêm hình ảnh';
        } else {
          topicContent.innerHTML = '<p>Nội dung đang được cập nhật...</p>';
          topicTitle.textContent = 'Chi tiết';
        }
        
        if (helpModal) helpModal.style.display = 'none';
        topicModal.style.display = 'block';
      }
    }

    function closeTopicModal() {
      const topicModal = document.getElementById('topicModal');
      const helpModal = document.getElementById('helpModal');

      if (topicModal) topicModal.style.display = 'none';
      if (helpModal) helpModal.style.display = 'block';
    }

    function showFooterModal(key) {
      const footerModal = document.getElementById('footerModal');
      const modalText = document.getElementById('modalText');

      if (footerModal && modalText) {
        const content = modalContentMapping[key] || "<p>Nội dung không khả dụng.</p>";
        modalText.innerHTML = content;
        footerModal.style.display = 'block';
      }
    }

    function closeFooterModal() {
      const footerModal = document.getElementById('footerModal');
      if (footerModal) {
        footerModal.style.display = 'none';
      }
    }

    // Close modals when clicking outside
    window.onclick = function(event) {
      const footerModal = document.getElementById('footerModal');
      const helpModal = document.getElementById('helpModal');
      const topicModal = document.getElementById('topicModal');
      const welcomePopup = document.getElementById('welcomePopup');

      if (event.target === footerModal) {
        footerModal.style.display = 'none';
      }
      if (event.target === helpModal) {
        helpModal.style.display = 'none';
      }
      if (event.target === topicModal) {
        topicModal.style.display = 'none';
        if (helpModal) helpModal.style.display = 'block';
      }
      if (event.target === welcomePopup) {
        welcomePopup.style.display = 'none';
      }
    };

    // Initialize on load
    document.addEventListener('DOMContentLoaded', function() {
      // Check if notification should be hidden
      if (localStorage.getItem('expandNotificationClosed') === 'true') {
        const notification = document.getElementById('expandNotification');
        if (notification) {
          notification.style.display = 'none';
        }
      }
      
      // Ensure welcome content is shown by default
      const welcomeContent = document.getElementById('welcomeContent');
      if (welcomeContent) {
        welcomeContent.classList.add('show');
      }

      // Add overlay click handler
      const overlay = document.getElementById('overlay');
      if (overlay) {
        overlay.addEventListener('click', handleOverlayClick);
      }
    });

    // Handle escape key to close modals
    document.addEventListener('keydown', function(event) {
      if (event.key === 'Escape') {
        const modals = ['footerModal', 'helpModal', 'topicModal', 'welcomePopup'];
        modals.forEach(modalId => {
          const modal = document.getElementById(modalId);
          if (modal && modal.style.display === 'block') {
            modal.style.display = 'none';
          }
        });
        
        // Close sidebars
        const sidebar = document.getElementById('sidebar');
        const feedbackSidebar = document.getElementById('feedbackSidebar');
        const overlay = document.getElementById('overlay');
        
        if (sidebar) sidebar.classList.remove('open');
        if (feedbackSidebar) feedbackSidebar.classList.remove('open');
        if (overlay) overlay.classList.remove('active');
      }
    });
  </script>
</body>
</html>
